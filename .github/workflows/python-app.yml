# This script uses the binary from https://github.com/vprover/vampire under the following license:
# 
# Vampire licence - BSD 3-Clause
# 
# Vampire Software Licence Agreement
# Copyright Â© 2020
# 
# Vampire is copyright (C) 2020 by
# its authors and contributors (see AUTHORS) and their institutional
# affiliations. All rights reserved.
# 
# The Vampire licence is a (modified) BSD 3-Clause licence.
# This Vampire licence supersedes all previous licences covering usage of Vampire.
# 
# 
# The source code of Vampire is open and available to students, researchers,
# software companies, and everyone else to study, to modify, and to redistribute
# original or modified versions; distribution is under the terms of the modified
# BSD licence (reproduced below).
# 
# Note that some software included with Vampire is available under a more permissive licence.
# For example, both Minisat and Z3 are used internally by Vampire.
# 
# In the below, this Software refers to Vampire in any form. 
# 
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions are
# met:
# 
# 1. Redistributions of source code must retain the above copyright
# notice, this list of conditions and the following disclaimer.
# 
# 2. Redistributions in binary form must reproduce the above copyright
# notice, this list of conditions and the following disclaimer in the
# documentation and/or other materials provided with the distribution.
# 
# 3. Neither the name of the copyright holder nor the names of its
# contributors may be used to endorse or promote products derived from
# this software without specific prior written permission.
# 
# 
# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT OWNERS AND CONTRIBUTORS
# ''AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
# LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
# A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
# OWNERS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
# SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
# LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
# OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
# 


name: Python application

on:
  push:
  pull_request:

permissions:
  contents: read

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - name: Set up Python 3.10
      uses: actions/setup-python@v3
      with:
        python-version: "3.10"
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install gavel-owl
        pip install ply
        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
    - name: Install robot
      run: |
        sudo wget --no-verbose -m -nH -nd -P /usr/bin https://raw.githubusercontent.com/ontodev/robot/master/bin/robot
        sudo wget --no-verbose -m -nH -nd -P /usr/bin https://github.com/ontodev/robot/releases/latest/download/robot.jar
        sudo chmod +x /usr/bin/robot
    - name: Install Vampire
      run: |
        sudo wget --no-verbose -m -nH -nd -P /usr/bin https://github.com/vprover/vampire/releases/download/v4.7/vampire4.7.zip
        sudo unzip /usr/bin/vampire4.7.zip -d /usr/bin
        sudo chmod +x /usr/bin/vampire_z3_rel_static_HEAD_6295
    - name: Merge all FIBO ontologies with robot
      run: |
        robot merge --input AboutFIBODev.rdf --output AboutFIBODevMerged.ttl --catalog /home/runner/work/fibo/fibo/catalog-v001.xml
    - name: Run gavel-owl
      run: |
        python -m gavel start-server
        python -m gavel translate owl tptp /home/runner/work/fibo/fibo/AboutFIBODevMerged.ttl > AboutFIBODevMerged.tptp
